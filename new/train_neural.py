import math
import os
import pickle
from typing import Tuple, Dict

import joblib
from sklearn.metrics import mean_squared_error
from sklearn.model_selection import train_test_split
import matplotlib.pyplot as plt
from kessler_game.src.kesslergame import KesslerController, Ship
import numpy as np
from func import angle360, ast_angle
from sklearn.neural_network import MLPRegressor



genes = [[0.11254164610724085, 0.16871673759444591, 0.2281084405150524, 0.28648363788652215, 0.9860567626772707, 0.42666307715123253], [0.0007265186042763455, 0.2565929202559351, 0.5006714067264266, 0.7501638343729407, 0.9999809907282693, 0.9999996550005207],
[0.11254164610724085, 0.16871673759444591, 0.2281084405150524, 0.28648363788652215, 0.9860567626772707, 0.42666307715123253], [0.0007265186042763455, 0.2565929202559351, 0.5006714067264266, 0.7501638343729407, 0.9999809907282693, 0.9436092230920367],
[9.399103541198866e-05, 0.26837899513836855, 0.500794605013952, 0.6098967523439601, 0.9999964561746745, 0.9150434051811708], [0.11468796553967131, 0.13875332623613987, 0.18413901224639825, 0.7344102305377468, 0.999967303720772, 0.8267512257461211],
[0.0053751874267201905, 0.26837899513836855, 0.18566334733666845, 0.9171277659687938, 0.9999972060710368, 0.9146677794188861], [0.10940676914836314, 0.13533381258744362, 0.352762470879052, 0.6089069598102004, 0.999966535599877, 0.8327884067517687],
[0.06618728838511181, 0.17269616883187855, 0.18261382918140046, 0.2989294743303965, 0.9997993543645936, 0.4460595151694259], [0.001183388019450157, 0.2662038638596766, 0.49879532481255867, 0.6436210457387336, 0.9999954836124625, 0.9551016808271205],
[0.1626050455874008, 0.17269616883187855, 0.18261382918140046, 0.6461622073087059, 0.999797210151051, 0.4460595151694259], [-8.644809710024737e-05, 0.2662038638596766, 0.49879532481255867, 0.296388312759999, 0.9999959764360378, 0.9551016808271205],
[0.10247029492400773, 0.149494291735954, 0.18413901224639825, 0.750021890841309, 0.9997631890983797, 0.8651074485369108], [0.0006934473959290941, 0.2684665181237993, 0.5007946112713747, 0.6784315608638605, 0.9999929372757951, 0.9150434051811708],
[0.10247029492400773, 0.15595891517308744, 0.17143998805324898, 0.750021890841309, 0.9997631890983797, 0.857902030513774], [0.0006934473959290941, 0.2620018946866658, 0.5134936354647379, 0.6784315608638605, 0.9999968049851959, 0.9131271772763805],
[0.020889680698811024, 0.1642545551478125, 0.16982263236218198, 0.7503376363382436, 0.9970172672605365, 0.939305284737615], [-0.0025916752855475976, 0.2566925701114459, 0.5006872500657856, 0.7503199184284917, 0.9999969488962641, 0.999351475941055],
[0.021153437083940404, 0.1642545551478125, 0.25498422360774176, 0.7503376363382436, 0.9998226162191095, 0.998301944948784], [-0.002855431670676978, 0.03731204106255939, 0.5006872500657856, 0.7635810718549083, 0.9971501188276028, 0.9398194543300536],
[1.07916244431773e-05, 0.2566925701114459, 0.5006714991449014, 0.7500195817968139, 0.9999969488962641, 0.9990124032384845], [4.155742708759799e-05, 0.2660102171571799, 0.4988733495879544, 0.753057996030876, 0.9999846849779293, 0.9552424740864566],
[4.350650267261165e-05, 0.2566925701114459, 0.5107055463911011, 0.8358301081963864, 0.9999969488962641, 0.9990124032384845], [8.842548858163641e-06, 0.2660102171571799, 0.4988756896941186, 0.753057996030876, 0.9999846849779293, 0.8815971725980788],
[0.04606323264662428, 0.1388732334736052, 0.18413901224639825, 0.8145642484879994, 0.9998513987966196, 0.8595663713527557], [7.984430174530296e-05, 0.26454656945149574, 0.5003737413393314, 0.627383483944507, 0.999997211548587, 0.9560729665158163],
[0.03268320663627983, 0.1388732334736052, 0.18413901224639825, 0.6281343291306717, 0.9999959216794998, 0.8595663713527557], [0.0020899683666086508, 0.26454656945149574, 0.5003737413393314, 0.8138134033015939, 0.9998518037158003, 0.9560729665158163],
[0.023657699238739345, 0.1642545551478125, 0.16982263236218198, 0.7502562453313887, 0.9999957387715742, 0.939305284737615], [0.10255273047244469, 0.1724693658894706, 0.20925785909233657, 0.42645321835384997, 0.9993163793173827, 0.42234537476463246],
[0.024080336206783542, 0.14324369500229156, 0.16982263236218198, 0.4270542297024997, 0.999974072285835, 0.957453370087589], [0.1021300935044005, 0.1643894673062791, 0.20925785909233657, 0.7496552339708903, 0.999330602433035, 0.42234537476463246],
[1.1335512976663115e-05, 0.2500233810178861, 0.5003164616352059, 0.7500158405751016, 0.9999945528502394, 0.9092695779907727], [8.975114203834074e-06, 0.26855370092138814, 0.500379140003093, 0.6123903531163234, 0.9999982575052178, 0.9150434051811708],
[0.08053066483189258, 0.2125005625135193, 0.5003164616352059, 0.7500158405751016, 0.9999945528502394, 0.8708816447094107], [8.975114203834074e-06, 0.26855370092138814, 0.500379140003093, 0.6123903531163234, 0.9999992759401267, 0.9150434051811708],
[0.06594854785713128, 0.17269616883187855, 0.18271094865656928, 0.7423810100035437, 0.9999773386606033, 0.8544969675353561], [-0.00042902191125354996, 0.2567339635172055, 0.5226765473523263, 0.7501581770355009, 0.999999638939879, 0.42610348392735764],
[0.06594854785713128, 0.2605649285308335, 0.18707188562633084, 0.7423810100035437, 0.9999773386606033, 0.8544969675353561], [-0.00042902191125354996, 0.16886520381825054, 0.5466035477519022, 0.7501581770355009, 0.999999638939879, 0.4493189008113637],
[3.47453080237109e-05, 0.2681955437335311, 0.5003157635491113, 0.7498950454583323, 0.9999993420371994, 0.9168961712564914], [0.059076305202001245, 0.2543543113334941, 0.515523142937637, 0.7513773786367828, 0.9999958143568787, 0.4248235194912286],
[0.06196313881409913, 0.34157522144444186, 0.5156555594081752, 0.7514015585051727, 0.9999993420371994, 0.29099523340767797], [0.000295159216381527, 0.2543543113334941, 0.5001833470785731, 0.7498708655899425, 0.9999958143568787, 0.9161972808975384],
[0.0006676016145045963, 0.26846325341032884, 0.5006750007340136, 0.6756479842319725, 0.9999929050268394, 0.9173505618578854], [0.06618728838511181, 0.17269616883187855, 0.18261382918140046, 0.2989294743303965, 0.9997993543645936, 0.4460595151694259],
[0.0638472902762694, 0.2660431637062711, 0.5006750007340136, 0.29992600037238637, 0.9999929050268394, 0.9373418212574799] ,[0.003007599723347014, 0.17511625853593624, 0.16826506192458177, 0.6746514581867024, 0.9448238611773645, 0.4442820415050522],
[0.10236506914966961, 0.1457060979186687, 0.1844871524147375, 0.7423810100035437, 0.9999977108032698, 0.8544969675353561] ,[0.02532552374026261, 0.2543685689166963, 0.5154203704550812, 0.7502565182731624, 0.9999409818991599, 0.4248852897876947],
[0.10236506914966961, 0.1457060979186687, 0.1844871524147375, 0.7423810100035437, 0.9999989170911757, 0.42173029547230223], [0.02532552374026261, 0.2543685689166963, 0.5154203704550812, 0.6878394034526577, 0.9999578701012427, 0.9003728353013598],
[0.10046909694441157, 0.1724693658894706, 0.20925785909233657, 0.42645321835384997, 0.9993163793173827, 0.42234537476463246], [-8.412392253183338e-05, 0.26454656945149574, 0.5003743378600788, 0.7488997964695495, 0.9999850912490218, 0.9560459856223125],
[0.10046909694441157, 0.26878668184121535, 0.21984815436344524, 0.42645321835384997, 0.9999800997461207, 0.9267401978700714], [-8.412392253183338e-05, 0.16822925349975099, 0.489784042588972, 0.7488997964695495, 0.9993178516269658, 0.5618699737586093],
[0.022055862331461895, 0.2567339635172055, 0.5226765473523263, 0.7510133025301524, 0.9999670019641731, 0.42610348392735764], [0.029038392179755144, 0.17203215717196385, 0.21750220797188208, 0.2899760905155529, 0.9929631896081588, 0.39153261998929967],
[0.029138965661908305, 0.24774110785326392, 0.5226765473523263, 0.7357066087996265, 0.9430847952013744, 0.42610348392735764], [0.09696627965768562, 0.17203215717196385, 0.21750220797188208, 0.3052827831753068, 0.9928346682476931, 0.39153261998929967],
[4.976155985775512e-05, 0.2682610482060078, 0.5007925746920108, 0.7502386172884405, 0.9999849186369261, 0.9173740071927181], [0.10236506914966961, 0.1457060979186687, 0.1844871524147375, 0.7423810100035437, 0.9999977108032698, 0.8544969675353561],
[0.10110890945434463, 0.2682610482060078, 0.5007925746920108, 0.7500973892447689, 0.9999849186369261, 0.9183267152442163], [0.020749268235933014, 0.1819216250073539, 0.1844871524147375, 0.7425222380472154, 0.9999977108032698, 0.8535442594838542],
[0.0006934473959290941, 0.2684665181237993, 0.5007946112713747, 0.6784315608638605, 0.9999929372757951, 0.9150434051811708], [0.11468796553967131, 0.13875332623613987, 0.18413901224639825, 0.7344102305377468, 0.999967303720772, 0.8267512257461211],
[0.0006934473959290941, 0.18102630703246814, 0.5030504222890719, 0.6771136124547401, 0.9999930520995932, 0.8272409345642721], [0.11468796553967131, 0.26858083455055404, 0.18188320122873836, 0.735728178946867, 0.9999671888538113, 0.91455369636285],
[8.975114203834074e-06, 0.26855370092138814, 0.500379140003093, 0.6123903531163234, 0.9999982575052178, 0.9150434051811708], [1.1335512976663115e-05, 0.2500233810178861, 0.5003164616352059, 0.7500158405751016, 0.9999945528502394, 0.9092695779907727],
[8.975114203834074e-06, 0.24952409469216646, 0.5003790015422013, 0.6111851953376, 0.9999984789456284, 0.77701163770357] ,[1.1335512976663115e-05, 0.26905298724710786, 0.5003166000960978, 0.7512209983538252, 0.999994331408924, 0.9091013660780212],
[0.10247029492400773, 0.149494291735954, 0.18413901224639825, 0.7505149950746621, 0.9997491935391364, 0.8651074485369108], [-0.00042902191125354996, 0.2567339635172055, 0.5226765473523263, 0.7501581770355009, 0.999999638939879, 0.42610348392735764],
[-0.00993075184028712, 0.15035209729643148, 0.18413901224639825, 0.7501828388288485, 0.9999827372076021, 0.8651074485369108], [-0.00042902191125354996, 0.255876157956728, 0.5226765473523263, 0.7504903332813144, 0.9997627638071187, 0.42610348392735764],
[0.0004250154108524738, 0.2500233810178861, 0.5003168625128811, 0.7501707907416161, 0.9999939018827805, 0.41911723116605837], [0.033206330682711414, 0.24065950463437355, 0.5006584480508647, 0.750066350732345, 0.9999212516807403, 0.28900824078463],
[-0.022508426761766252, 0.2500233810178861, 0.5003358752468563, 0.7501701784240943, 0.9999685809814153, 0.41911723116605837], [0.0332569257519961, 0.24065950463437355, 0.5006394353168895, 0.8533598357360924, 0.9999960718927824, 0.28900824078463],
[0.06657517713268789, 0.14551624925429935, 0.1844871524147375, 0.7423810100035437, 0.9999988744106177, 0.8544969675353561], [0.0007704298755855483, 0.2664834824634669, 0.49887298137888436, 0.662767977296745, 0.9999917128379787, 0.9552381623679713],
[0.06693447666980905, 0.14551624925429935, 0.1844871524147375, 0.7463613004520954, 0.9999987840138533, 0.8553064269984965], [0.00041113033846439107, 0.2664834824634669, 0.49887298137888436, 0.6587876868481933, 0.9999918029673693, 0.9544287010310865],
[0.06657517713268789, 0.14551624925429935, 0.1844871524147375, 0.7423810100035437, 0.9999988744106177, 0.8544969675353561], [1.1335512976663115e-05, 0.2500233810178861, 0.5003164218524239, 0.7500173801745708, 0.9999948276514858, 0.39120672166240883],
[0.06657517713268789, 0.2500034239232804, 0.1844871524147375, 0.7422985769613535, 0.9999988744106177, 0.8596894272972528], [1.1335512976663115e-05, 0.14553620634890505, 0.5003164218524239, 0.7500998132167609, 0.9999948276514858, 0.38601381997839346],
[1.7990987481782822e-06, 0.2565929202559351, 0.5006753158680058, 0.7501644351207518, 0.9999997464515469, 0.9999448021015175], [0.0006897356656283178, 0.26846325341032884, 0.5007695305996938, 0.7988578410594039, 0.999994537215981, 0.9173505618578854],
[1.7990987481782822e-06, 0.2565929202559351, 0.5007710873899508, 0.7501644351207518, 0.9999997464515469, 0.9999448021015175], [-0.06673215931791554, 0.1921710783236829, 0.5006737590777489, 0.7988578410594039, 0.999994537215981, 0.9173505618578854],
[0.0951859824522733, 0.1724693658894706, 0.20925785909233657, 0.42645321835384997, 0.9968870805706525, 0.42666307715123253], [-8.153044115147756e-05, 0.24915518255723434, 0.5003144022384085, 0.7500187130608472, 0.9999972451120915, 0.2887419570096328],
[0.0951859824522733, 0.1724693658894706, 0.5010290223565357, 0.42645321835384997, 0.996965009220632, 0.293537596254971], [-8.153044115147756e-05, 0.24915518255723434, 0.20854323897421193, 0.7500187130608472, 0.9998737969588976, 0.4218674379058943],
[0.11468796553967131, 0.13875332623613987, 0.1848231239664813, 0.7344102305377468, 0.9999990984251957, 0.8267512257461211], [0.0951859824522733, 0.1724693658894706, 0.20925785909233657, 0.42645321835384997, 0.9968870805706525, 0.42666307715123253],
[0.11468796553967131, 0.13875332623613987, 0.1848231239664813, 0.7344102305377468, 0.996857989909379, 0.8267512257461211], [0.0951859824522733, 0.1758902807627744, 0.20925785909233657, 0.42645321835384997, 0.999969610495274, 0.42666307715123253],
[0.029038392179755144, 0.16734217783441352, 0.21750220797188208, 0.2899760905155529, 0.9969748802426162, 0.39153261998929967], [3.47453080237109e-05, 0.2681955437335311, 0.5003157635491113, 0.7498950454583323, 0.9999993420371994, 0.9168961712564914],
[0.029038392179755144, 0.272007161900597, 0.3201627517093213, 0.2899760905155529, 0.9969827387513107, 0.39130788921942455], [3.47453080237109e-05, 0.16353055966734764, 0.5003157635491113, 0.7498950454583323, 0.8497041434031678, 0.8782621486126337],
[0.028809353787312735, 0.153823848578776, 0.17492951586725505, 0.749640686102428, 0.999985061752101, 0.9672791270849641], [0.020725978448701055, 0.2543685689166963, 0.511533814364754, 0.7501528816682149, 0.999999057840805, 0.4266436107208103],
[0.028620536032103232, 0.257906867722614, 0.4665840260675248, 0.7544359584671639, 0.9999997281867978, 0.9672791270849641], [0.028966392175647972, 0.1502855497728583, 0.16606490855194445, 0.7501528816682149, 0.999986000298422, 0.4266436107208103],
[-0.0025911022778179957, 0.2566925701114459, 0.5006872505928591, 0.7503195042257806, 0.9999989804585616, 0.9993346903240701], [0.0006519534917449989, 0.25273136582557415, 0.5001678362643142, 0.7485926646030477, 0.9999993464283348, 0.2867912959387968],
[-0.0025911022778179957, 0.25664682625918944, 0.5006714623472451, 0.7503195042257806, 0.9999989804585616, 0.9966949724619644], [0.007908278412759333, 0.2527771096778306, 0.5001836245099281, 0.7485926646030477, 0.9999993464283348, 0.26865394822123756],
[1.1105520320462792e-05, 0.16399024484738173, 0.16775269904992893, 0.7502189635005588, 0.9999922579613078, 0.952763987226428], [9.399103541198866e-05, 0.26837899513836855, 0.500794605013952, 0.6098967523439601, 0.9999964561746745, 0.9150434051811708],
[1.1105520320462792e-05, 0.16399024484738173, 0.13160146690234698, 0.6092673684756899, 0.9999921842889452, 0.953082889899651], [9.399103541198866e-05, 0.26837899513836855, 0.5140724498772931, 0.750848347368829, 0.9911091001384241, 0.9147245025079449],
[0.0007266680899849418, 0.2565929202559351, 0.5006872624748203, 0.7502196869060991, 0.999954262815274, 0.9999907517730626], [0.02335236087253992, 0.2500023807941755, 0.5003775988071895, 0.7502515004708106, 0.9999968258981218, 0.40234887079946346],
[0.08227334052413154, 0.2565929202559351, 0.5006872624748203, 0.7234375936166072, 0.9999963416113812, 0.9999957003340683], [0.02335236087253992, 0.2500023807941755, 0.5003775988071895, 0.6295864925164201, 0.9999547199957681, 0.40234887079946346],
[4.976155985775512e-05, 0.2682610482060078, 0.5007925746920108, 0.7502386172884405, 0.9999849186369261, 0.9173740071927181], [0.10046909694441157, 0.1724693658894706, 0.20925785909233657, 0.42645321835384997, 0.9993163793173827, 0.42234537476463246],
[4.976155985775512e-05, 0.2682610482060078, 0.49559971176232837, 0.4465991051271717, 0.9999774420635283, 0.9132178522852484], [-0.021377369290613485, 0.1724693658894706, 0.20925785909233657, 0.7300927305047229, 0.9993204056220607, 0.4264878460087594],
[0.00010169654238277072, 0.2502007556795895, 0.5001840272424213, 0.7505074777567858, 0.999984846721441, 0.2867912959387968], [0.1611656765127928, 0.2657520484352208, 0.23456800518908316, 0.590960817823772, 0.7633094794117463, 0.7568324749638108],
[0.00010169654238277072, 0.2666981243476044, 0.22333981093883662, 0.7411875077817829, 0.9966609963275146, 0.26522706516613864], [0.1611656765127928, 0.20810795757726647, 0.5114122214926695, 0.6002807877987746, 0.7627358674670008, 0.778396682109455],
[0.029038392179755144, 0.16734217783441352, 0.21750220797188208, 0.2899760905155529, 0.9929631896081588, 0.39153261998929967], [0.1997658670992036, 0.13875332623613987, 0.1848231239664813, 0.7344102305377468, 0.9999990984251957, 0.8267512257461211],
[0.2056440874374466, 0.16734217783441352, 0.2191095761433898, 0.27997745536439655, 0.9850169782255228, 0.8352867704457211], [0.023160171841532004, 0.13875332623613987, 0.18439906081131965, 0.744408864182343, 0.9883708072034162, 0.38299698970886475],
[0.029038392179755144, 0.16734217783441352, 0.21750220797188208, 0.2899760905155529, 0.9964366207554576, 0.39153261998929967], [0.11254164610724085, 0.16871673759444591, 0.2281084405150524, 0.28648363788652215, 0.9860567626772707, 0.42666307715123253],
[0.029038392179755144, 0.16734217783441352, 0.21750220797188208, 0.2899760905155529, 0.9964366207554576, 0.39153261998929967], [0.11254164610724085, 0.16871673759444591, 0.2281084405150524, 0.28648363788652215, 0.9860567626772707, 0.42666307715123253],
[0.0006666990458945947, 0.26834823660655954, 0.5006758881741475, 0.7767777086545157, 0.9999945506243152, 0.9168961712564914], [0.0011833808942754709, 0.2494239064428743, 0.5046540335816957, 0.7565235376178353, 0.9999998137034956, 0.2860980533563964],
[0.0006666990458945947, 0.26801779784812974, 0.5005881272637632, 0.7774797977347098, 0.9782395746983912, 0.2886686452768002], [0.0011833808942754709, 0.24975434520130413, 0.5047417944920801, 0.7558214485376412, 0.9999998137034956, 0.9142706471912716],
[0.059076305202001245, 0.2543543113334941, 0.515523142937637, 0.7513773786367828, 0.9999958143568787, 0.4248235194912286] ,[0.04606323264662428, 0.1388732334736052, 0.18413901224639825, 0.8145642484879994, 0.9998513987966196, 0.8595663713527557],
[0.059076305202001245, 0.2543543113334941, 0.515523142937637, 0.8184928671794042, 0.9999958143568787, 0.8761242951927658] ,[0.03762561304011206, 0.1388732334736052, 0.21501403147706108, 0.747448759945378, 0.9998513987966196, 0.4215580061230376],
[0.06618728838511181, 0.17269616883187855, 0.18261382918140046, 0.2989294743303965, 0.999812670226458, 0.4460595151694259], [2.0385609029495173e-06, 0.26454656945149574, 0.5003737413393314, 0.6461705576338533, 0.999997211548587, 0.9560459856223125],
[0.06482973142726381, 0.17269616883187855, 0.18261382918140046, 0.28658124679904373, 0.999812670226458, 0.462957439533916], [0.001359595518750957, 0.26454656945149574, 0.5003737413393314, 0.6585187851627938, 0.999997211548587, 0.938945381517316],
[0.1997658670992036, 0.13875332623613987, 0.1848231239664813, 0.7344102305377468, 0.9999990984251957, 0.8267512257461211], [0.0006897356656283178, 0.26846325341032884, 0.5007695305996938, 0.7988578410594039, 0.999994537215981, 0.9173505618578854],
[-0.03637409888152443, 0.13132524788058486, 0.1848231239664813, 0.7344102305377468, 0.9999990984251957, 0.8267512257461211], [0.0006897356656283178, 0.2758913317658839, 0.5007695305996938, 0.7988578410594039, 0.9999965970995992, 0.9173505618578854],
[0.059076305202001245, 0.2543543113334941, 0.515523142937637, 0.7513773786367828, 0.9999958143568787, 0.4248235194912286], [0.033206330682711414, 0.24065950463437355, 0.5006584480508647, 0.750066350732345, 0.9999212516807403, 0.28900824078463],
[0.059076305202001245, 0.24013979109275402, 0.5841997817978443, 0.7513773786367828, 0.9999213001265558, 0.4248235194912286], [0.033206330682711414, 0.2548740248751136, 0.5011810833626403, 0.750066350732345, 0.9999956685086949, 0.28900824078463],
[0.029038392179755144, 0.17203215717196385, 0.21750220797188208, 0.2899760905155529, 0.9929631896081588, 0.39153261998929967], [0.0006666990458945947, 0.26834823660655954, 0.5006758881741475, 0.7767777086545157, 0.9999945506243152, 0.9168961712564914],
[0.02817747036853909, 0.17203215717196385, 0.21750220797188208, 0.3510837479877157, 0.9929631896081588, 0.9193074231113687], [0.001527620857110645, 0.26834823660655954, 0.5006758881741475, 0.8427508184763342, 0.9999945506243152, 0.2809770152563861],
[-8.153044115147756e-05, 0.24915518255723434, 0.5003144022384085, 0.7500187130608472, 0.9999972451120915, 0.2887419570096328], [0.02335236087253992, 0.2500023807941755, 0.5003775988071895, 0.7502515004708106, 0.9999968258981218, 0.40234887079946346],
[-0.0014784685618155942, 0.24998697349494492, 0.5003791043051566, 0.7500187130608472, 0.9999972451120915, 0.4026878297778657], [0.02474929899320404, 0.24917058985646495, 0.5003128967404413, 0.5152639640740282, 0.9999968258981218, 0.28840299803123054],
[0.11254164610724085, 0.16871673759444591, 0.2281084405150524, 0.28648363788652215, 0.9860567626772707, 0.42666307715123253], [0.029038392179755144, 0.16734217783441352, 0.21750220797188208, 0.2899760905155529, 0.9929631896081588, 0.39153261998929967],
[0.029055839845491184, 0.16871673759444591, 0.21795270748526063, 0.2899506753447709, 0.993419923273609, 0.38972770586445776], [0.11252419844150482, 0.16734217783441352, 0.22765794100167386, 0.2865090530573041, 0.9929631896081588, 0.42846799127607443],
[0.1611656765127928, 0.2657520484352208, 0.23456800518908316, 0.590960817823772, 0.7633094794117463, 0.7568324749638108], [1.1335512976663115e-05, 0.2500233810178861, 0.5003164218524239, 0.7500173801745708, 0.9999948276514858, 0.39120672166240883],
[-0.0029603953432740526, 0.2657520484352208, 0.4969428993310663, 0.7473392535139449, 0.7633094794117463, 0.7441135426622172], [0.16413740736907076, 0.2500233810178861, 0.23794152771044091, 0.5936389444843977, 0.9999948276514858, 0.378191429664622],
[4.845995888237922e-07, 0.2682610482060078, 0.5007930236486611, 0.7500205542566911, 0.9991444245479789, 0.9149111777812196], [0.0007792869515649665, 0.2662038638596766, 0.49887298137888436, 0.7972838799684547, 0.9999930920557272, 0.955087814487264],
[-5.370007047066734e-05, 0.2682610482060078, 0.5007193453970736, 0.7516352579963829, 0.9999695090734021, 0.9859905909058201], [0.0008334716216244577, 0.20835149606346154, 0.49894665963047174, 0.795669176228763, 0.9991595151205553, 0.9189464495006844],
[0.0007266680899849418, 0.2565929202559351, 0.5006872624748203, 0.7502196869060991, 0.999954262815274, 0.9999907517730626], [0.06594854785713128, 0.17269616883187855, 0.18271094865656928, 0.7423810100035437, 0.9999773386606033, 0.8544969675353561],
[0.11943519580599074, 0.17233291460455993, 0.5006872624748203, 0.7502196869060991, 0.999954262815274, 0.9999907517730626], [0.06714474205854878, 0.2569561744832537, 0.18271094865656928, 0.7423810100035437, 0.9999773386606033, 0.7688176661505232],
[0.06618728838511181, 0.17269616883187855, 0.18261382918140046, 0.2989294743303965, 0.999812670226458, 0.4460595151694259], [7.984430174530296e-05, 0.26454656945149574, 0.5006892087083246, 0.7401879583379021, 0.999997211548587, 0.9560729665158163],
[0.1512651899447619, 0.17269616883187855, 0.18261382918140046, 0.2989294743303965, 0.999812670226458, 0.4460595151694259], [7.984430174530296e-05, 0.26454656945149574, 0.5006892087083246, 0.7401879583379021, 0.999997211548587, 0.9560729665158163],
[0.0004250154108524738, 0.2500233810178861, 0.5003168625128811, 0.7501707907416161, 0.9999939018827805, 0.41911723116605837], [0.029038392179755144, 0.17203215717196385, 0.21750220797188208, 0.28997804400046967, 0.9979778694022696, 0.39153261998929967],
[0.033785931135917366, 0.23802354790667796, 0.5003168625128811, 0.7501707907416161, 0.9999939018827805, 0.41911723116605837], [0.029038392179755144, 0.17203215717196385, 0.21750220797188208, 0.28997804400046967, 0.9979778694022696, 0.39153261998929967],
[0.029038392179755144, 0.17203215717196385, 0.21750220797188208, 0.28994467117789563, 0.9979778694022696, 0.39153261998929967], [0.05225785460411272, 0.14551624925429935, 0.1844871524147375, 0.7424116420601905, 0.9999998698539777, 0.8544969675353561],
[0.029038392179755144, 0.14319161575904213, 0.21750220797188208, 0.28994467117789563, 0.9979778694022696, 0.25117255531012794], [0.05225785460411272, 0.14551624925429935, 0.1844871524147375, 0.7424116420601905, 0.9999998698539777, 0.8544969675353561],
[0.11254164610724085, 0.16871673759444591, 0.2281084405150524, 0.28648363788652215, 0.9860567626772707, 0.42666307715123253] ,[0.029038392179755144, 0.16734217783441352, 0.21750220797188208, 0.2899760905155529, 0.9964366207554576, 0.39153261998929967],
[0.027306459384797553, 0.16871673759444591, 0.2281084405150524, 0.28648363788652215, 0.9860567626772707, 0.42666307715123253], [0.11427357890219844, 0.16734217783441352, 0.21750220797188208, 0.2899760905155529, 0.9964366207554576, 0.39153261998929967],
[0.00011049788699098862, 0.25273136582557415, 0.5001678362643142, 0.7485926646030477, 0.9999845371080659, 0.2867912959387968], [0.029038392179755144, 0.16734217783441352, 0.21750220797188208, 0.2899760905155529, 0.9929631896081588, 0.39153261998929967],
[0.00011049788699098862, 0.25273136582557415, 0.5001678362643142, 0.6757270667734306, 0.9999845371080659, 0.2867912959387968], [0.029038392179755144, 0.16734217783441352, 0.21750220797188208, 0.2899760905155529, 0.9929631896081588, 0.39153261998929967]
]

#labels_maximize, labels_minimize = zip(*[running(gene, best_out, wall_left_easy) for gene in genes])
#print("評価終了")

file_path = 'inout_list3.txt'


with open(file_path) as f:
    lines = f.readlines()

X = []
y = []
for line in lines:
    values = line.strip().split(',')
    x_values = list(map(float, values[:2]))
    y_values = list(map(float, values[2:4]))
    X.append(x_values)
    y.append(y_values)
# 距離5分割，センターアングルは2分割，隕石の速度とサイズを入力，MFの遺伝子のみを正規化
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
# ニューラルネットワークのモデル
model = MLPRegressor(hidden_layer_sizes=(10, 5), max_iter=100000)
# イテレーションごとのトレーニング
Loss_train = []
Loss_test = []
NGEN = 100000
"""file = 'NNmodel.sav'
loaded_model = joblib.load(file)
print(X_test)
result = loaded_model.predict([X_test[0]])
print(result)"""
for i in range(1, NGEN+1):
    # モデルの再作成
    model.partial_fit(X_train, y_train)
    # テストデータで評価
    y_pred_train = model.predict(X_train)
    y_pred_test = model.predict(X_test)
    # 損失関数の計算
    loss_train = mean_squared_error(y_train, y_pred_train)
    loss_test = mean_squared_error(y_test, y_pred_test)

    Loss_train.append(loss_train)
    Loss_test.append(loss_test)
    if i % 2000 == 0:


        # 結果の表示
        print(f"Iteration: {i}")
        print("Actual Labels:")
        print(y_test)
        print("Predicted Labels:")
        print(y_pred_test)

#横方向に結合して確かめる

"""file = 'NNmodel.sav'
pickle.dump(model, open(file, 'wb'))"""
#損失関数のプロット
plt.figure()
plt.plot(np.arange(0, NGEN, 1), Loss_train, label='train')
plt.plot(np.arange(0, NGEN, 1), Loss_test, label='test')
plt.title("Loss of Neural Network predicting game score")
plt.xlabel("Iteration")
plt.ylabel("Loss")
plt.legend()
plt.show()



"""
1回目
Iteration: 100000
Actual Labels Maximize:
[0.5041029568769438, 0.65, 0.5693478619341237, 0.5182621082621083, 0.7185381668140289, 0.65, 0.5739583333333333, 0.45297466858603863, 0.6121212121212121, 0.7370306027299629, 0.4913256955810147, 0.4980350818848872, 0.7185381668140289, 0.47070890332256854, 0.5527635327635327, 0.8717361896301081, 0.5858585858585859, 0.6225488288557959, 0.8641597448720736, 0.8455026455026455, 0.5447517289380543, 0.8820893697658783, 0.44958419573744807, 0.5019698805353676, 0.8903142589118198, 0.8629948364888124, 0.8862803862803863, 0.5309509815446103, 0.45075049561030867, 0.7125866655890297, 0.7685818713450292, 0.6274995030808984, 0.4703127383676583, 0.5694915254237288, 0.6617886178861788, 0.8350236441142954, 0.7395579048399105, 0.5661043555025054, 0.7395579048399105, 0.48333857442348005]
Predicted Labels Maximize:
[ 0.61244297  0.78519728  0.12479714 -0.06471336  0.68191789  0.97029451
  0.45357787  1.109648    0.91278039  0.73749144  0.06011671 -0.09701939
  0.68191789  0.53579403  0.65190055  0.80358022  0.63023887  0.58986801
  0.87831524  0.86409754  0.52150892  0.82107265  0.48796401  0.52215997
  0.88314138  0.80729037  0.88001166  0.26598817  0.4498689   0.68462222
  0.82469773  0.63404244  0.41083079  0.57130401  0.64925286  0.8193523
  0.73201958  0.52332466  0.73201958  0.5871791 ]
Actual Labels Minimize:
[0.2925280250116549, 0.09776061169827639, 0.7839857068539753, 0.7945961676288187, 0.8612547262497479, 0.04228468328147846, 0.0003724658909309294, 0.2611208115217374, 0.020699842596532896, 0.9121484616768427, 0.14561089809819955, 0.9972130473746283, 0.8612547262497479, 0.02306928046918768, 0.04625613460095611, 0.4681830817045364, 0.052512673766972995, 0.08033532375303648, 0.49057099053482356, 0.15655320541714385, 0.0010091104997384335, 0.4401328622665236, 0.6417800879336399, 0.0012622180710813217, 0.5574180927986143, 0.01935708310939083, 0.4941918910494896, 0.46569023106080865, 0.838079422523412, 0.857781295102449, 0.124975397715372, 0.3524296784475202, 0.09385317973729347, 0.02970929669450357, 0.48581639807151583, 0.4504302414867528, 0.9431760674339497, 0.012937231947436623, 0.9431760674339497, 0.0009421478004552994]
Predicted Labels Minimize:
[ 3.10123718e-01  8.50018124e-02  7.96189809e-01  8.08114226e-01
  8.59549282e-01  1.77114291e-02  2.59031028e-02  1.78060829e-01
  1.62682973e-02  9.08862094e-01  2.08231374e-01  9.85717618e-01
  8.59549282e-01 -2.19969398e-03  3.87998159e-02  4.66850896e-01
  5.07547301e-02  9.25508837e-02  4.90395892e-01  1.48922145e-01
  8.44620127e-04  4.40269778e-01  6.35544461e-01  1.75897748e-03
  5.56184199e-01  1.69838336e-02  4.94067842e-01  4.80800371e-01
  8.44300381e-01  8.56393047e-01  1.16802069e-01  3.40676379e-01
  9.35098089e-02  2.61991211e-02  4.31506241e-01  4.47324365e-01
  9.38578032e-01  3.37492738e-03  9.38578032e-01  9.32615735e-03]

Iteration: 100000
Actual Labels Maximize:
[0.5041029568769438, 0.65, 0.5693478619341237, 0.5182621082621083, 0.7185381668140289, 0.65, 0.5739583333333333, 0.45297466858603863, 0.6121212121212121, 0.7370306027299629, 0.4913256955810147, 0.4980350818848872, 0.7185381668140289, 0.47070890332256854, 0.5527635327635327, 0.8717361896301081, 0.5858585858585859, 0.6225488288557959, 0.8641597448720736, 0.8455026455026455, 0.5447517289380543, 0.8820893697658783, 0.44958419573744807, 0.5019698805353676, 0.8903142589118198, 0.8629948364888124, 0.8862803862803863, 0.5309509815446103, 0.45075049561030867, 0.7125866655890297, 0.7685818713450292, 0.6274995030808984, 0.4703127383676583, 0.5694915254237288, 0.6617886178861788, 0.8350236441142954, 0.7395579048399105, 0.5661043555025054, 0.7395579048399105, 0.48333857442348005]
Predicted Labels Maximize:
[0.3820465  0.73003667 0.70823811 0.81757154 0.68149656 0.74928085
 0.65783781 0.87014068 0.77591341 0.73268118 0.4675896  0.50818055
 0.68149656 0.53080398 0.56602367 0.76859574 0.57545211 0.60898829
 0.85358691 0.81655762 0.53427984 0.79480077 0.6523746  0.52877087
 0.80272454 0.78709055 0.8519342  0.52088469 0.44456447 0.67255789
 0.82220695 0.80735315 0.44274222 0.54601568 0.54276561 0.84751579
 0.75107866 0.52529662 0.75107866 0.55442922]
Actual Labels Minimize:
[0.2925280250116549, 0.09776061169827639, 0.7839857068539753, 0.7945961676288187, 0.8612547262497479, 0.04228468328147846, 0.0003724658909309294, 0.2611208115217374, 0.020699842596532896, 0.9121484616768427, 0.14561089809819955, 0.9972130473746283, 0.8612547262497479, 0.02306928046918768, 0.04625613460095611, 0.4681830817045364, 0.052512673766972995, 0.08033532375303648, 0.49057099053482356, 0.15655320541714385, 0.0010091104997384335, 0.4401328622665236, 0.6417800879336399, 0.0012622180710813217, 0.5574180927986143, 0.01935708310939083, 0.4941918910494896, 0.46569023106080865, 0.838079422523412, 0.857781295102449, 0.124975397715372, 0.3524296784475202, 0.09385317973729347, 0.02970929669450357, 0.48581639807151583, 0.4504302414867528, 0.9431760674339497, 0.012937231947436623, 0.9431760674339497, 0.0009421478004552994]
Predicted Labels Minimize:
[0.36887694 0.09809919 0.76594105 0.77736047 0.85632338 0.03733865
 0.05585399 0.29114913 0.03833627 0.90230479 0.16914598 0.97455011
 0.85632338 0.00350151 0.11212859 0.49326961 0.05208805 0.10574872
 0.50753867 0.16451662 0.02558492 0.46633604 0.63639951 0.02647757
 0.56485978 0.04229092 0.51078727 0.47272195 0.83193939 0.85285428
 0.13951136 0.37588158 0.13588284 0.01297636 0.44097585 0.47168797
 0.92423655 0.01790173 0.92423655 0.04464411]
 
 Iteration: 100000
Actual Labels Maximize:
[0.5041029568769438, 0.65, 0.5693478619341237, 0.5182621082621083, 0.7185381668140289, 0.65, 0.5739583333333333, 0.45297466858603863, 0.6121212121212121, 0.7370306027299629, 0.4913256955810147, 0.4980350818848872, 0.7185381668140289, 0.47070890332256854, 0.5527635327635327, 0.8717361896301081, 0.5858585858585859, 0.6225488288557959, 0.8641597448720736, 0.8455026455026455, 0.5447517289380543, 0.8820893697658783, 0.44958419573744807, 0.5019698805353676, 0.8903142589118198, 0.8629948364888124, 0.8862803862803863, 0.5309509815446103, 0.45075049561030867, 0.7125866655890297, 0.7685818713450292, 0.6274995030808984, 0.4703127383676583, 0.5694915254237288, 0.6617886178861788, 0.8350236441142954, 0.7395579048399105, 0.5661043555025054, 0.7395579048399105, 0.48333857442348005]
Predicted Labels Maximize:
[0.55703194 0.7370819  0.42914508 0.53777533 0.67356513 0.72167746
 0.70951995 0.63448376 0.75195081 0.70772237 0.58298544 0.52756046
 0.67356513 0.60252985 0.60167674 0.81453963 0.61727509 0.57841386
 0.87753959 0.79530835 0.51286262 0.74092659 0.60019415 0.51520067
 0.79422962 0.74636803 0.87616749 0.56007206 0.45422505 0.67399026
 0.78552212 0.85912849 0.53152754 0.61472221 0.79495872 0.79050136
 0.64689381 0.51468764 0.64689381 0.60603484]
Actual Labels Minimize:
[0.2925280250116549, 0.09776061169827639, 0.7839857068539753, 0.7945961676288187, 0.8612547262497479, 0.04228468328147846, 0.0003724658909309294, 0.2611208115217374, 0.020699842596532896, 0.9121484616768427, 0.14561089809819955, 0.9972130473746283, 0.8612547262497479, 0.02306928046918768, 0.04625613460095611, 0.4681830817045364, 0.052512673766972995, 0.08033532375303648, 0.49057099053482356, 0.15655320541714385, 0.0010091104997384335, 0.4401328622665236, 0.6417800879336399, 0.0012622180710813217, 0.5574180927986143, 0.01935708310939083, 0.4941918910494896, 0.46569023106080865, 0.838079422523412, 0.857781295102449, 0.124975397715372, 0.3524296784475202, 0.09385317973729347, 0.02970929669450357, 0.48581639807151583, 0.4504302414867528, 0.9431760674339497, 0.012937231947436623, 0.9431760674339497, 0.0009421478004552994]
Predicted Labels Minimize:
[0.33992417 0.06946497 0.83730775 0.83642509 0.85856505 0.04392897
 0.01145725 0.31269908 0.01720147 0.91473516 0.12344343 1.00266021
 0.85856505 0.00684875 0.04892523 0.46810974 0.06240156 0.0879741
 0.49251515 0.14927457 0.00744961 0.44280012 0.6465184  0.00697272
 0.55775164 0.01606576 0.494624   0.45358567 0.82031018 0.85570521
 0.12057894 0.3654686  0.09510321 0.03958601 0.44280012 0.44280012
 0.94364795 0.02044638 0.94364795 0.00533922]



"""
